<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Tapestry : Tapestry" />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Tapestry</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/FlowForwarding/tapestry">View on GitHub</a>

          <h1 id="project_title">Tapestry</h1>
          <h2 id="project_tagline">Tapestry</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/FlowForwarding/tapestry/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/FlowForwarding/tapestry/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a name="tapestry-a-network-complexity-analyzer" class="anchor" href="#tapestry-a-network-complexity-analyzer"><span class="octicon octicon-link"></span></a>Tapestry: A Network Complexity Analyzer</h1>

<h2>
<a name="overview" class="anchor" href="#overview"><span class="octicon octicon-link"></span></a>Overview</h2>

<p>Tapestry is a system that measures network complexity by capturing Domain
Name System (DNS) endpoint interaction data via OpenFlow enabled network
taps in front of one or more of an organization's internal recursive DNS
servers.</p>

<p>Network interaction data is collected over time, distinct organizational
activities are detected, and a Network Complexity Index (NCI) is computed
on-line.  The NCI can be viewed and graphed in near real-time via a built
in Web based interface.</p>

<h2>
<a name="requirements" class="anchor" href="#requirements"><span class="octicon octicon-link"></span></a>Requirements</h2>

<p>Tapestry requires:</p>

<ul>
<li>Erlang/OTP distributed computing platform, available from
<a href="http://www.erlang.org/download.html">Erlang.org</a>
</li>
<li>One or more servers running the Erlang to aggregate the data and 
calculate the NCI.</li>
<li>One or more internal recursive DNS servers to provide the raw data feeds</li>
<li>One or more OpenFlow enabled switches or network white boxes with at
least 3 ports to act as network taps. (or you can install LINC on
the network white boxes)</li>
<li>Network cabling and access to install the taps inline in front of
the internal recursive DNS servers</li>
<li>Network connectivity between the taps and machine or cluster running 
the Erlang/OTP</li>
</ul><h2>
<a name="installation" class="anchor" href="#installation"><span class="octicon octicon-link"></span></a>Installation</h2>

<p>Download and compile the Tapestry collector</p>

<div class="highlight highlight-bash"><pre>% git clone https://github.com/FlowForwarding/tapestry
% <span class="nb">cd </span>tapestry
% make
</pre></div>

<p>If required, download and compile LINC for the network switches</p>

<div class="highlight highlight-bash"><pre>% git clone https://github.com/FlowForwarding/LINC-Switch.git
</pre></div>

<p>You will need to create <code>$LINC_ROOT/rel/files/sys.config</code> by adding the correspond ports and adding the Tapestry
Controller.  There are 2 ports needed for Tapestry Controller and hence, we can generate a sys.config somelike below.</p>

<div class="highlight highlight-bash"><pre>% <span class="nb">cd</span> <span class="nv">$LINC_ROOT</span>
% scripts/config_gen -s 0 eth1 eth2 eth3 eth4 -c tcp:10.10.10.75:6633 tcp:10.10.10.75:6634 -o rel/files/sys.config
% make compile
% make rel
</pre></div>

<h2>
<a name="deployment" class="anchor" href="#deployment"><span class="octicon octicon-link"></span></a>Deployment</h2>

<p>An example deployment diagram: <img src="https://raw.github.com/FlowForwarding/tapestry/master/docs/images/tapestry_deployment.jpg" alt="alt text" title="Tapestry deployment"></p>

<h2>
<a name="configure-tapestry-collector" class="anchor" href="#configure-tapestry-collector"><span class="octicon octicon-link"></span></a>Configure Tapestry Collector</h2>

<p>Tapestry Collector Configuration file is located in
$TAPESTRY_ROOT/tapestry.config file</p>

<p>In the below file, LINC Switch IP Address is 10.10.10.149 and DNS Server
connected to Port 1 (as per LINC Switch's sys.config file) of the LINC
Switch is 10.10.10.10.  Port 2 (as per LINC Switch's sys.config file) of
the LINC Switch is connected to the Top of the Rack switch to act as a
receptor for DNS Queries and responses.</p>

<div class="highlight highlight-erlang"><pre><span class="p">{</span><span class="n">ofdps</span><span class="p">,[{</span><span class="n">ofdp</span><span class="p">,{</span><span class="n">ip_addr</span><span class="p">,{</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">149</span><span class="p">}},</span>
              <span class="p">{</span><span class="n">dns_port</span><span class="p">,</span><span class="mi">1</span><span class="p">},</span>
              <span class="p">{</span><span class="n">client_port</span><span class="p">,</span><span class="mi">2</span><span class="p">},</span>
              <span class="p">{</span><span class="n">dns_ips</span><span class="p">,[{</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">}]}</span>
         <span class="p">}]}.</span>
</pre></div>

<h2>
<a name="running-tapestry" class="anchor" href="#running-tapestry"><span class="octicon octicon-link"></span></a>Running Tapestry</h2>

<h3>
<a name="first-install-flows-on-the-switch-and-make-sure-everything-is-working" class="anchor" href="#first-install-flows-on-the-switch-and-make-sure-everything-is-working"><span class="octicon octicon-link"></span></a>First Install Flows on the Switch and make sure everything is working</h3>

<div class="highlight highlight-erlang"><pre><span class="err">#</span> <span class="n">erl</span> <span class="o">-</span><span class="n">pa</span> <span class="n">ebin</span>
<span class="o">&gt;</span> <span class="nn">tap_loom</span><span class="p">:</span><span class="nf">start</span><span class="p">().</span>
<span class="o">&gt;</span> <span class="nn">tap_loom</span><span class="p">:</span><span class="nf">config</span><span class="p">().</span>
<span class="o">&gt;</span> <span class="n">q</span><span class="p">().</span>
</pre></div>

<p>Now test connectivity.  If the DNS Server IP address connected to Port 1 of the LINC Switch is 10.10.10.10, then</p>

<div class="highlight highlight-bash"><pre><span class="c"># dig @10.10.10.10 flowforwarding.org</span>
</pre></div>

<p>Now you can start Tapestry Collector</p>

<div class="highlight highlight-erlang"><pre><span class="err">#</span> <span class="n">erl</span> <span class="o">-</span><span class="n">pa</span> <span class="n">ebin</span>
<span class="o">&gt;</span> <span class="nn">tapestry</span><span class="p">:</span><span class="nf">start</span><span class="p">().</span>
</pre></div>

<p>Using a browser, go to URL - http://&lt;tapestry_collector_hostname:28080/nci.html to see NCI graph and number.</p>

<h2>
<a name="additional-documentation" class="anchor" href="#additional-documentation"><span class="octicon octicon-link"></span></a>Additional Documentation</h2>

<blockquote>
<ol>
<li>Technical White Paper: “<a href="http://www.flowforwarding.org/nci-article">A Network Complexity Index for Networks of Networks</a>” by Stuart Bailey and Robert L. Grossman</li>
<li>NCI White Paper: <a href="http://www.infoblox.com/downloads/resources/network-complexity/download">Tapestry for Tracking Network Complexity Index (NCI)</a>
</li>
<li>Tapestry <a href="https://github.com/FlowForwarding/tapestry/blob/master/docs/Tapestry.pdf?raw=true">Architecture Details</a>
</li>
</ol>
</blockquote>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Tapestry maintained by <a href="https://github.com/FlowForwarding">FlowForwarding</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-45275436-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>


  </body>
</html>
